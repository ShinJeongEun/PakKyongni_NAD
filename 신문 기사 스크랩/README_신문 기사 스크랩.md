# 신문 기사 스크랩

이 폴더는 **국내 주요 일간지 기사 메타데이터/본문을 자동 수집**하기 위한 주피터 노트북들을 모아둔 디렉터리입니다.  
신문사별 페이지 구조와 접근 정책이 달라 각각 전용 노트북을 제공하며, 공통적으로 검색 범위(키워드/기간)와 출력 형식을 통일합니다.

## 폴더 구성 (예시)

- `1경향신문.ipynb` – 경향신문 기사 수집  
- `1국민일보.ipynb` – 국민일보 기사 수집  
- `1동아일보.ipynb` – 동아일보(1996-10-14 이전 지면 아카이브 포함)  
- `1문화일보.ipynb` – 문화일보 기사 수집  
- `1서울신문.ipynb` – 서울신문 기사 수집  
- `5네이버뉴스라이브러리.ipynb` – 네이버 뉴스 라이브러리(지면 기사 API 연동)

> 일부 신문사는 **로그인/세션 유지**가 필요하거나, **연도/월 단위 분할 수집**이 필요합니다.

## 환경 설정

```bash
# 권장 파이썬 버전: 3.9+
pip install -r requirements.txt
# requirements.txt가 없으면 기본 패키지 설치
pip install pandas openpyxl requests beautifulsoup4 lxml selenium webdriver-manager
```

- **크롬 브라우저** 설치 권장  
- 셀레니움 사용 시 `webdriver-manager`로 드라이버를 자동 관리  
- 일부 신문사는 로그인 세션 필요 (예: 카카오 로그인 버튼)  
  - `ChromeOptions`에서 `--user-data-dir=...` 지정 시 기존 로그인 세션 재사용 가능

## 실행 방법

1. Jupyter Notebook 실행
   ```bash
   jupyter notebook
   ```
2. 신문사별 노트북을 열고 상단 설정 셀에서 다음 항목 지정:
   - `QUERY` (검색어)
   - `DATE_FROM` / `DATE_TO`
   - `MAX_PAGES`
   - 출력 경로 및 파일명 규칙
3. 위에서 아래로 셀 순서대로 실행  
   - 기본적으로 **10페이지 단위**로 진행 로그 출력

## 출력물

- 기본 출력 형식: `xlsx` (필요 시 `csv`, `parquet` 가능)  
- 권장 파일명 규칙:
  ```
  data/<신문사>/<YYYYMMDD>_<신문사>_<키워드>_<기간>.xlsx
  ```
- 주요 컬럼:
  - `media`, `date`, `title`, `subtitle`, `author`, `section`, `url`, `articleId`,  
    `content`, `page_no`, `edition`, `images`, `scraped_at`

## 특수 케이스

### 네이버 뉴스 라이브러리
- 지면 기사의 메타데이터 및 본문을 API로 수집  
- 고유 키: `articleId` (중복 제거 시 `url`과 함께 사용)

### 동아일보 (1996-10-14 이전 지면)
- 아카이브 구조 별도 처리 필요  
- 면/쪽 정보 포함 저장  
- 경우에 따라 로그인 세션 필요 (예: 카카오 버튼 클릭 자동화)

## 중복 제거 및 정규화

- 중복 제거 우선순위: `articleId` > `url` > (`title`, `date`)  
- 텍스트 정규화: 줄바꿈/공백/특수문자 정리  
- `media` 컬럼은 신문사 **한글 명칭** 유지

## 크롤링 정책 및 주의사항

- 각 신문사 **이용약관** 및 **robots.txt** 준수  
- 요청 간 지연(`SLEEP`)을 설정하여 과도한 요청 방지  
- HTTP 500/429 발생 시 재시도 또는 대기 후 재실행  
- 세션 만료 발생 시 재로그인 후 마지막 수집 페이지부터 이어 실행 가능

## 자주 발생하는 문제와 해결책

- **버튼 클릭 실패/지연** → headless 해제, `WebDriverWait` 증가  
- **인피니트 스크롤 불가** → `document.body.scrollHeight` 변화 감지  
- **인코딩 깨짐** → `.encoding='utf-8'` 지정, `lxml` 파서 사용  
- **대용량 저장 속도 저하** → `parquet` 포맷 권장

## 라이선스 및 인용

- 본 데이터는 **연구/교육 목적**에 한해 사용하세요.  
- 각 매체의 저작권을 존중해야 합니다.  
- 인용 시 **신문사 / 날짜 / URL**을 함께 표기하는 것을 권장합니다.

---

### 변경 이력 (예시)
- 2025-08: 네이버 뉴스 라이브러리 API 파라미터 정리 및 스키마 통일  
- 2025-08: 진행 로그 출력 간격을 50페이지 → 10페이지 단위로 변경
